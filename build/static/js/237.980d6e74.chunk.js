"use strict";(self.webpackChunkfinal_project_frontend=self.webpackChunkfinal_project_frontend||[]).push([[237],{1906:function(e,n,t){t.r(n),t.d(n,{default:function(){return ce}});var i=t(5987),r=t(4165),a=t(2982),o=t(1413),c=t(5861),s=t(885),l=t(2791),d=t(7002),u=t(6015),h=t(2455),x=t(4565),p=t(5209),m=t(1872),f=t(7205),v=t(1137),g=t(3746),Z=t(1992),j=t(5777),b=t(7237),C=t(7488),k=t(9954),y=t(7689),w=t(5985),N=t(184),I=function(e){var n,t,i=e.comic,r=e.isFavorited,a=e.handleCreateFavorite,o=e.handleDeleteFavorite,c=(0,l.useState)(!0),d=(0,s.Z)(c,2),h=d[0],I=d[1],B=S(),L=((0,y.useParams)().id,(0,y.useNavigate)()),R=(0,l.useMemo)((function(){var e;return null===(e=i.Chaps)||void 0===e?void 0:e.length}),[i]);return(0,N.jsxs)("div",{className:B.comicInfoWrapper,children:[(0,N.jsx)("img",{src:i.image,alt:i.name,className:B.imageCard}),(0,N.jsxs)("div",{style:{flex:1},children:[(0,N.jsx)(x.Z,{fontSize:"28px",textTransform:"uppercase",mb:1,children:i.name}),(0,N.jsxs)(u.Z,{display:"flex",alignItems:"center",my:2,children:[(0,N.jsx)(x.Z,{sx:{marginRight:"10px"},children:"T\xe1c gi\u1ea3:"}),null===(n=i.Authors)||void 0===n?void 0:n.map((function(e){return(0,N.jsx)(p.Z,{sx:{bgcolor:"#ff8a80","&:hover":{backgroundColor:"#ef9a9a"},marginLeft:"10px"},label:e.name,onClick:function(){return L("/comic/author/".concat(e.id))}},e.id)}))]}),(0,N.jsxs)(u.Z,{display:"flex",flexWrap:"wrap",lineHeight:"50px",alignItems:"center",children:[(0,N.jsx)(x.Z,{sx:{marginRight:"5px"},children:"Th\u1ec3 lo\u1ea1i"}),(0,N.jsx)(v.Z,{}),":",null===(t=i.Genres)||void 0===t?void 0:t.map((function(e){return(0,N.jsx)(p.Z,{sx:{bgcolor:"#ff8a80","&:hover":{backgroundColor:"#ef9a9a"},marginLeft:"10px"},label:e.name,onClick:function(){return L("/genres/".concat(e.id))}},e.id)}))]}),(0,N.jsxs)(u.Z,{display:"flex",my:2,gap:2,children:[(0,N.jsxs)(u.Z,{display:"flex",children:[(0,N.jsx)(g.Z,{}),(0,N.jsx)(x.Z,{sx:{ml:"10px",color:"#ea6016"},children:i.viewCount}),(0,N.jsx)(x.Z,{ml:1,children:"L\u01b0\u1ee3t Xem"})]}),(0,N.jsx)(m.Z,{sx:{borderColor:"#757575"},orientation:"vertical",flexItem:!0}),(0,N.jsxs)(u.Z,{display:"flex",children:[(0,N.jsx)(b.Z,{}),(0,N.jsx)(x.Z,{sx:{ml:"10px",color:"#ea6016"},children:i.voteCount}),(0,N.jsx)(x.Z,{ml:1,children:"L\u01b0\u1ee3t th\xedch"})]}),(0,N.jsx)(m.Z,{sx:{borderColor:"#757575"},orientation:"vertical",flexItem:!0}),(0,N.jsxs)(u.Z,{display:"flex",children:[(0,N.jsx)(Z.Z,{}),(0,N.jsx)(x.Z,{sx:{ml:"10px",color:"#ea6016"},children:R}),(0,N.jsx)(x.Z,{ml:1,children:"Ch\u01b0\u01a1ng"})]})]}),(0,N.jsxs)(u.Z,{display:"inline-flex",children:[(0,N.jsx)(x.Z,{mr:1,children:"N\u1ed9i dung"}),(0,N.jsx)(j.Z,{}),"\xa0",":"]}),i.description.length<250?(0,N.jsx)("span",{style:{marginLeft:"5px"},children:i.description}):h?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("span",{style:{marginLeft:"5px"},children:(0,k.Sy)(i.description,i.description.length/2)}),(0,N.jsx)(x.Z,{mt:1,onClick:function(){return I(!h)},color:"primary.main",sx:{cursor:"pointer"},children:"Xem th\xeam"})]}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("span",{style:{marginLeft:"5px"},children:i.description}),(0,N.jsx)(x.Z,{mt:1,onClick:function(){return I(!h)},color:"primary.main",sx:{cursor:"pointer"},children:"Thu g\u1ecdn"})]}),(0,N.jsxs)(u.Z,{display:"flex",mt:5,width:"50%",children:[(0,N.jsx)(f.Z,{onClick:function(){i&&i.Chaps&&i.Chaps.length>0?L((0,k.No)(i.name,i.Chaps[i.Chaps.length-1].chapName,i.Chaps[i.Chaps.length-1].id)):w.Am.error("Truy\u1ec7n ch\u01b0a c\xf3 chap n\xe0o , h\u1ec7 th\u1ed1ng s\u1ebd c\u1eadp nh\u1eadt ngay khi c\xf3 chap",{containerId:"B"})},sx:{flex:1,fontSize:"18px",borderRadius:"8px"},variant:"contained",children:"\u0110\u1ecdc truy\u1ec7n"}),(0,N.jsx)(f.Z,{sx:{ml:2,flex:1,bgcolor:r?"#d2d3d9":"#ff9d11",borderRadius:"8px","&:hover":{bgcolor:r?"#d2d3d9":"#ff9d11"},gap:1},onClick:r?o:a,variant:"contained",children:r?(0,N.jsx)(x.Z,{fontSize:"18px",children:"\u0110\xe3 y\xeau th\xedch"}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(C.Z,{}),(0,N.jsx)(x.Z,{fontSize:"18px",children:"Y\xeau th\xedch"})]})})]})]})]})},S=(0,h.Z)((function(e){return{comicInfoWrapper:{display:"flex",backgroundColor:e.palette.background.default,padding:e.spacing(2)},imageCard:{height:"320px",width:"240px",objectFit:"cover",marginRight:e.spacing(3),flexShrink:0}}})),B=t(9434),L=t(4293),R=t(166),T=function(e){var n=e.children,t=e.index,i=e.value;return(0,N.jsx)("div",{role:"tabpanel",id:"tabpanel-".concat(t),hidden:i!==t,"aria-labelledby":"tab-".concat(t),children:i===t&&n})},z=t(5953),F=t(5814),A=t(7962),D=t(1087),W=function(e){var n=e.chapList,t=e.bookName,i=P();return(0,N.jsx)(z.ZP,{sx:{mt:1},container:!0,spacing:2,children:(0,k.qi)(n,"chapName",!0).reverse().map((function(e){return(0,N.jsx)(z.ZP,{item:!0,xs:3,children:e.chapName.length<23?(0,N.jsx)(D.rU,{style:{textDecoration:"none"},to:(0,k.No)(t,e.chapName,e.id),children:(0,N.jsx)(f.Z,{variant:"outlined",className:i.chapNameButton,children:e.chapName})}):(0,N.jsx)(F.Z,{classes:{tooltip:i.customTooltip},arrow:!0,TransitionComponent:A.Z,TransitionProps:{timeout:600},placement:"top",title:e.chapName,children:(0,N.jsx)(D.rU,{style:{textDecoration:"none"},to:(0,k.No)(t,e.chapName,e.id),children:(0,N.jsx)(f.Z,{variant:"outlined",className:i.chapNameButton,children:e.chapName})})})},e.id)}))})},P=(0,h.Z)((function(e){return{imageCard:{height:"320px",width:"240px",objectFit:"cover",marginRight:e.spacing(3)},customTooltip:{backgroundColor:"#e3f2fd",fontSize:"14px",color:e.palette.text.primary,width:"200px"},chapNameButton:{width:"200px",color:e.palette.text.primary,display:"block",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis","&.MuiButton-outlined":{borderColor:"rgba(0,0,0,.12)"}}}})),E=t(3978),M=t(5065),U=t(1686),_=function(e){var n=e.handleCreateComment,t=G(),i=(0,y.useLocation)(),r=(0,l.useState)(""),a=(0,s.Z)(r,2),o=a[0],c=a[1];return(0,l.useEffect)((function(){c("")}),[i.pathname]),(0,N.jsx)("div",{children:(0,N.jsxs)(u.Z,{display:"flex",mb:1,margin:"30px 0px",gap:1,height:"auto",children:[(0,N.jsx)(E.Z,{sx:{width:50,height:50}}),(0,N.jsxs)(u.Z,{display:"flex",flexDirection:"column",gap:2,flex:1,children:[(0,N.jsx)(M.Z,{size:"small",value:o,fullWidth:!0,placeholder:"B\xecnh lu\u1eadn g\xec \u0111\xf3 !",variant:"outlined",onChange:function(e){return c(e.target.value)},InputProps:{classes:{notchedOutline:t.borderComment}}}),(0,N.jsx)(u.Z,{alignSelf:"flex-end",px:"14px",children:(0,N.jsx)(f.Z,{onClick:function(){o&&(c(""),n(o))},endIcon:(0,N.jsx)(U.Z,{}),size:"small",variant:"contained",children:"B\xecnh lu\u1eadn"})})]})]})})},G=(0,h.Z)((function(e){return{borderComment:{borderTop:"none",borderLeft:"none",borderRight:"none",left:"14px",right:"14px",borderRadius:"0px"}}})),H=t(1834),O=t(4732),X=function(e){var n,t=e.comment;return(0,N.jsx)("div",{children:(0,N.jsxs)(u.Z,{display:"flex",mb:1,margin:"30px 0px",gap:3,height:"auto",alignItems:"center",children:[(0,N.jsx)(E.Z,{sx:{width:50,height:50}}),(0,N.jsxs)(u.Z,{children:[(0,N.jsxs)(u.Z,{display:"flex",gap:3,children:[(0,N.jsx)(x.Z,{fontWeight:"bold",mb:2,whiteSpace:"nowrap",children:null===(n=t.User)||void 0===n?void 0:n.username}),(0,N.jsx)(x.Z,{mb:2,whiteSpace:"nowrap",children:(0,H.Z)(new Date(t.createdAt),{locale:O.Z,addSuffix:!0})})]}),(0,N.jsx)(x.Z,{whiteSpace:"nowrap",children:t.content})]})]})})},q=t(4520),Y=function(e){var n=e.commentList,t=e.checkCommentList;return(0,N.jsxs)("div",{children:[t.length>0&&(0,N.jsxs)(u.Z,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:2,children:[(0,N.jsx)(q.Z,{sx:{fontSize:"100px"}}),(0,N.jsx)(x.Z,{variant:"h5",color:"#889096",children:"Ch\u01b0a c\xf3 b\xecnh lu\u1eadn n\xe0o"}),(0,N.jsx)(x.Z,{fontSize:"20px",children:"H\xe3y l\xe0 ng\u01b0\u1eddi \u0111\u1ea7u ti\xean b\xecnh lu\u1eadn"})]}),n.map((function(e){return(0,N.jsx)(u.Z,{display:"flex",flexDirection:"column",children:(0,N.jsx)(X,{comment:e})},e.id)}))]})},J=t(7982),K=t(3938),Q=t(7943),V=t(7278),$=function(){var e=ee(),n=(0,l.useState)(!1),t=(0,s.Z)(n,2),i=t[0],o=t[1],d=(0,l.useState)([]),u=(0,s.Z)(d,2),h=u[0],p=u[1],m=(0,B.I0)(),f=(0,B.v9)((function(e){return e.profile.user})),v=(0,B.v9)((function(e){return e.comicReader.comicInfo})),g=(0,B.v9)((function(e){return e.comic.commentList})),Z=(0,l.useCallback)(function(){var e=(0,c.Z)((0,r.Z)().mark((function e(n){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(!0),t={bookId:null===v||void 0===v?void 0:v.id,content:n},e.next=4,m((0,J.z)(K.i.createComment,"post",t));case 4:e.sent.success&&(p([]),j(),o(!1)),o(!1);case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[null===v||void 0===v?void 0:v.id,m]),j=(0,l.useCallback)((0,c.Z)((0,r.Z)().mark((function e(){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(!0),e.next=3,m((0,J.z)("".concat(K.i.getAllCommentByBook,"/").concat(null===v||void 0===v?void 0:v.id),"get"));case 3:(n=e.sent).success&&(0===n.data.length&&p([1]),m((0,Q.v3)((0,a.Z)(n.data))),o(!1)),o(!1);case 6:case"end":return e.stop()}}),e)}))),[null===v||void 0===v?void 0:v.id,m]);return(0,l.useEffect)((function(){g.length>0&&g[0].bookId===(null===v||void 0===v?void 0:v.id)||j()}),[j]),(0,N.jsxs)("div",{className:e.root,children:[i&&(0,N.jsx)(V.Z,{}),(0,N.jsx)(x.Z,{variant:"h4",children:"B\xecnh lu\u1eadn ( ".concat(g.length," )")}),f?(0,N.jsx)(_,{handleCreateComment:Z}):(0,N.jsx)(x.Z,{textAlign:"center",my:2,children:"B\u1ea1n c\u1ea7n ph\u1ea3i \u0111\u0103ng nh\u1eadp \u0111\u1ec3 b\xecnh lu\u1eadn"}),(0,N.jsx)(Y,{checkCommentList:h,commentList:g})]})},ee=(0,h.Z)((function(e){return{root:{padding:e.spacing(3)},borderComment:{borderTop:"none",borderLeft:"none",borderRight:"none",left:"14px",right:"14px",borderRadius:"0px"}}})),ne=function(e){var n=e.chapList,t=e.bookName,i=(e.chapterList,(0,l.useState)(0)),r=(0,s.Z)(i,2),a=r[0],c=r[1],d=te(),h=function(e){return{id:"tab-".concat(e),"aria-controls":"tabpanel-".concat(e)}};return(0,N.jsxs)("div",{className:d.comicInfoNavigationWrapper,children:[(0,N.jsx)(u.Z,{sx:{borderBottom:1,borderColor:"divider"},children:(0,N.jsxs)(L.Z,{value:a,onChange:function(e,n){c(n)},children:[(0,N.jsx)(R.Z,(0,o.Z)({label:"Ch\u01b0\u01a1ng"},h(0))),(0,N.jsx)(R.Z,(0,o.Z)({label:"B\xecnh lu\u1eadn"},h(1)))]})}),(0,N.jsx)(T,{index:0,value:a,children:(0,N.jsx)(W,{bookName:t,chapList:n})}),(0,N.jsx)(T,{index:1,value:a,children:(0,N.jsx)($,{})})]})},te=(0,h.Z)((function(e){return{comicInfoNavigationWrapper:{backgroundColor:e.palette.background.default,padding:e.spacing(2),width:"75%"},imageCard:{height:"320px",width:"240px",objectFit:"cover",marginRight:e.spacing(3)}}})),ie=function(e){var n=e.relationComics,t=e.totalRelevantBooksChap,i=re(),r=((0,y.useNavigate)(),(0,l.useCallback)((function(e){var n;return null===(n=t.find((function(n){return n.bookId===e})))||void 0===n?void 0:n.count}),[t]));return(0,N.jsxs)("div",{className:i.relateComicWrapper,children:[(0,N.jsx)(x.Z,{variant:"h4",children:"Truy\u1ec7n T\u01b0\u01a1ng T\u1ef1"}),n.map((function(e){var n,t,a;return(0,N.jsx)(D.rU,{style:{textDecoration:"none",color:"unset"},to:"/details/".concat(e.id),children:(0,N.jsxs)(u.Z,{mt:2,display:"flex",width:"250px",height:"106px",justifyContent:"space-between",children:[(0,N.jsx)(u.Z,{width:"30%",children:(0,N.jsx)("img",{src:e.image,alt:e.name,className:i.imageCard})}),(0,N.jsxs)(u.Z,{paddingLeft:2,width:"70%",display:"flex",flexDirection:"column",justifyContent:"space-between",children:[(0,N.jsx)("div",{className:i.comicTitle,children:(0,N.jsx)(x.Z,{variant:"h6",children:e.name})}),(0,N.jsx)(x.Z,{variant:"body2",color:"text.secondary",children:null===(n=e.Genres)||void 0===n||null===(t=n[Math.floor(Math.random()*(null===(a=e.Genres)||void 0===a?void 0:a.length))])||void 0===t?void 0:t.name}),(0,N.jsx)(x.Z,{variant:"body2",color:"text.secondary",children:"".concat(r(e.id)," ch\u01b0\u01a1ng")})]})]},e.id)},e.id)}))]})},re=(0,h.Z)((function(e){return{relateComicWrapper:{backgroundColor:e.palette.background.default,padding:e.spacing(2),width:"25%"},imageCard:{width:"100%",height:"100%",objectFit:"cover"},comicTitle:{whiteSpace:"normal",display:"-webkit-box","-webkit-box-orient":"vertical","-webkit-line-clamp":"2",overflow:"hidden"}}})),ae=t(8812),oe=["id"],ce=function(){var e=(0,l.useState)(),n=(0,s.Z)(e,2),t=n[0],h=n[1],x=(0,B.v9)((function(e){return e.profile.user})),p=(0,y.useLocation)(),m=(0,l.useState)(!1),f=(0,s.Z)(m,2),v=f[0],g=f[1],Z=(0,l.useState)(!1),j=(0,s.Z)(Z,2),b=j[0],C=j[1],k=(0,l.useState)([]),S=(0,s.Z)(k,2),L=S[0],R=S[1],T=(0,l.useState)([]),z=(0,s.Z)(T,2),F=z[0],A=z[1],D=(0,B.I0)(),W=se(),P=(0,y.useParams)().id,E=(0,l.useCallback)((0,c.Z)((0,r.Z)().mark((function e(){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g(!0),e.next=3,D((0,J.z)("".concat(K.i.bookById,"/").concat(P),"get"));case 3:n=e.sent,h((0,o.Z)({},n.data.book)),R((0,a.Z)(n.data.relevantBooks)),A((0,a.Z)(n.data.totalRelevantBooksChap)),D((0,ae.R)((0,o.Z)({},n.data.book))),g(!1);case 9:case"end":return e.stop()}}),e)}))),[D,P]),M=(0,l.useCallback)((0,c.Z)((0,r.Z)().mark((function e(){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={bookId:P},e.next=3,D((0,J.z)(K.i.checkCurrentBookFavorited,"post",n));case 3:e.sent.success&&C(!0);case 5:case"end":return e.stop()}}),e)}))),[D,P]),U=(0,l.useCallback)((0,c.Z)((0,r.Z)().mark((function e(){var n,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=6;break}return t.id,n=(0,i.Z)(t,oe),e.next=4,D((0,J.z)("".concat(K.i.updateBook,"/").concat(t.id),"put",(0,o.Z)((0,o.Z)({},n),{},{voteCount:b?n.voteCount-1:n.voteCount+1})));case 4:(a=e.sent).success&&h((0,o.Z)((0,o.Z)({},t),{},{voteCount:a.data.voteCount}));case 6:case"end":return e.stop()}}),e)}))),[t,D,b]),_=(0,l.useCallback)((0,c.Z)((0,r.Z)().mark((function e(){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(x){e.next=3;break}return w.Am.info("B\u1ea1n c\u1ea7n \u0111\u0103ng nh\u1eadp \u0111\u1ec3 c\xf3 th\u1ec3 th\u1ef1c hi\u1ec7n ch\u1ee9c n\u0103ng y\xeau th\xedch",{containerId:"B"}),e.abrupt("return");case 3:return n={bookId:null===t||void 0===t?void 0:t.id},e.next=6,D((0,J.z)(K.i.createFavorite,"post",n));case 6:e.sent.success&&(U(),C(!0),w.Am.success("\u0110\xe3 th\xeam truy\u1ec7n v\xe0o m\u1ee5c y\xeau th\xedch",{containerId:"A"}));case 8:case"end":return e.stop()}}),e)}))),[null===t||void 0===t?void 0:t.id,D,U]),G=(0,l.useCallback)((0,c.Z)((0,r.Z)().mark((function e(){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={bookId:null===t||void 0===t?void 0:t.id},e.next=3,D((0,J.z)(K.i.deleteFavorite,"delete",n));case 3:e.sent.success&&(U(),C(!1),w.Am.success("\u0110\xe3 b\u1ecf th\xedch truy\u1ec7n",{containerId:"A"}));case 5:case"end":return e.stop()}}),e)}))),[null===t||void 0===t?void 0:t.id,D,U]);return(0,l.useEffect)((function(){C(!1)}),[p.pathname]),(0,l.useEffect)((function(){E(),x&&M()}),[x,E,M]),(0,N.jsx)(d.Z,{background:"background.neutral",isReadScreen:!1,children:(0,N.jsxs)("div",{className:W.root,children:[v&&(0,N.jsx)(V.Z,{}),t&&!v&&(0,N.jsx)(I,{comic:t,handleCreateFavorite:_,handleDeleteFavorite:G,isFavorited:b}),(0,N.jsxs)(u.Z,{display:"flex",mt:3,alignItems:"flex-start",gap:2,children:[t&&t.Chaps&&(0,N.jsx)(ne,{bookName:t.name,chapList:t.Chaps}),(0,N.jsx)(ie,{totalRelevantBooksChap:F,relationComics:L})]})]})})},se=(0,h.Z)((function(e){return{root:{width:"1200px",margin:"0 auto",paddingTop:"88px ",paddingBottom:"28px",position:"relative"}}}))}}]);
//# sourceMappingURL=237.980d6e74.chunk.js.map